<!doctype html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0b0b0f" />

  <title>SaverIoFlow â€” App</title>
  <meta name="description" content="SaverIoFlow app: daily/weekly/year plans, compass wizard, reviews, offline-first." />

  <!-- PWA (absolute paths to avoid /app vs /app/ issues) -->
  <link rel="manifest" href="/app/manifest.webmanifest" />
  <link rel="apple-touch-icon" href="/images/icon-192.png" />

  <!-- App styles -->
  <link rel="stylesheet" href="/theme.css" />
  <link rel="stylesheet" href="/components.css" />
  <link rel="stylesheet" href="/app/app.css" />
</head>

<body class="app">
  <!-- App topbar -->
  <header class="appTop">
    <div class="appTop-left">
      <div class="brand">
        <span class="brand-mark">SAVERIOFLOW</span>
      </div>
    </div>

    <div class="appTop-right">
      <!-- Language Switch -->
      <div class="langSwitch">
        <label class="langLabel" for="langSelect" data-i18n="lang.label">Language</label>
        <select id="langSelect" aria-label="Language">
          <option value="en" data-i18n="lang.en">English</option>
          <option value="de" data-i18n="lang.de">German</option>
          <option value="es" data-i18n="lang.es">Spanish</option>
          <option value="it" data-i18n="lang.it">Italian</option>
          <option value="ar" data-i18n="lang.ar">Arabic</option>
        </select>
      </div>

      <button class="btn btn-ghost" id="installBtn" type="button">Install</button>
    </div>
  </header>

  <!-- Tabs -->
  <nav class="tabs" aria-label="Primary">
    <button class="tab is-active" type="button" data-view="today" data-i18n="tabs.today">Today</button>
    <button class="tab" type="button" data-view="week" data-i18n="tabs.week">Week</button>
    <button class="tab" type="button" data-view="year" data-i18n="tabs.year">Year</button>
    <button class="tab" type="button" data-view="compass" data-i18n="tabs.compass">Compass</button>
    <button class="tab" type="button" data-view="review" data-i18n="tabs.review">Review</button>
  </nav>

  <!-- Views + Wraps (OS v2 erwartet diese Struktur) -->
  <main class="views">
    <section id="viewToday" class="view is-active"></section>

    <div id="weekWrap" class="viewWrap is-hidden">
      <section id="viewWeek" class="view"></section>
    </div>

    <div id="yearWrap" class="viewWrap is-hidden">
      <section id="viewYear" class="view"></section>
    </div>

    <div id="compassWrap" class="viewWrap is-hidden">
      <section id="viewCompass" class="view"></section>
    </div>

    <div id="reviewWrap" class="viewWrap is-hidden">
      <section id="viewReview" class="view"></section>
    </div>
  </main>

  <!-- i18n -->
  <script src="/i18n/en.js"></script>
  <script src="/i18n/de.js"></script>
  <script src="/i18n/es.js"></script>
  <script src="/i18n/it.js"></script>
  <script src="/i18n/ar.js"></script>
  <script src="/i18n/i18n.js"></script>
  <script>
    try { window.SIF_I18N && window.SIF_I18N.init(); } catch(e){ console.warn("i18n init failed:", e); }
  </script>

  <!-- App logic (absolute path!) -->
  <script src="/app/app.js"></script>

  <!-- Language switch wiring -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const sel = document.getElementById("langSelect");
      if (!sel || !window.SIF_I18N) return;

      sel.value = window.SIF_I18N.getCurrent();
      sel.addEventListener("change", (e) => window.SIF_I18N.set(e.target.value));
      window.addEventListener("sif:lang-changed", (ev) => {
        if (ev?.detail?.lang) sel.value = ev.detail.lang;
      });
    });
  </script>
</body>
</html>
